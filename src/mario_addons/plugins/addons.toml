

[[command]]
name="xpath"
short_help = "Find xml elements matching xpath query."
arguments = [{name="query", type="str"}]
inject_values=["query"]


help = """Pull data out of xml documents using xpath.

For example,

.. code-block:: bash


    $ mario xpath '//'  map 'x.text' <<EOF
          <slide type="all">
            <title>Overview</title>
              <item>Anything<em>can be</em> in here</item>
              <item>Or<em>also</em> in here</item>
          </slide>
    EOF
    Overview
    Anything
    can be
    Or
    also

"""

[[command.stages]]
command = "read-text"

[[command.stages]]
command = "map"
params = {code="x.encode() ! io.BytesIO ! lxml.etree.parse ! x.findall(query) ! map(lambda y: y, x) ! list" }

[[command.stages]]
command="chain"


[[command.tests]]
invocation = ["xpath", "//", "map", "x.text"]
input = '''
<slide type="all">
<title>Overview</title>
<item>Anything in here</item>
</slide>
'''
output = """
Overview
Anything in here
"""
